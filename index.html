<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aerospace, Dive, & Expedition Medicine Student Interest Group</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            overflow-x: hidden; /* Prevent horizontal scrollbar from canvas */
        }
        .font-orbitron {
            font-family: 'Orbitron', sans-serif;
        }
        .form-checkbox:checked {
            background-color: #3b82f6; /* blue-500 */
            border-color: #3b82f6; /* blue-500 */
        }
        .form-checkbox:checked:hover {
            background-color: #2563eb; /* blue-600 */
            border-color: #2563eb; /* blue-600 */
        }
        #starfield {
            position: fixed; /* Use fixed to ensure it covers the whole viewport */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
        }
        /* Accordion styles */
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s cubic-bezier(0, 1, 0, 1);
        }
        .accordion-content.open {
            max-height: 1000px; /* Set a large enough max-height */
            transition: max-height 1s ease-in-out;
        }
        .accordion-icon {
            transition: transform 0.3s ease;
        }
        .accordion-button.open .accordion-icon {
            transform: rotate(180deg);
        }
        /* Spinner for button */
        .loader {
            border: 2px solid #f3f3f3;
            border-top: 2px solid #3498db;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-right: 8px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-slate-900 text-white">

    <!-- Animated Background -->
    <canvas id="starfield"></canvas>

    <div class="relative z-10 min-h-screen flex flex-col items-center justify-center p-4 sm:p-6 lg:p-8">
        <div class="max-w-5xl w-full bg-slate-800/70 backdrop-blur-md rounded-2xl shadow-2xl p-8 md:p-12 border border-slate-700">

            <!-- Header Section -->
            <div id="header" class="text-center mb-8">
                <h1 class="font-orbitron text-3xl sm:text-4xl lg:text-5xl font-bold tracking-wider text-cyan-300">ADEM SIG</h1>
                <p class="mt-2 text-lg sm:text-xl text-slate-300">Aerospace, Dive, & Expedition Medicine</p>
                <p class="mt-4 max-w-3xl mx-auto text-slate-400">
                    Welcome new students! We're dedicated to exploring medicine in the most extreme environments. Let us know what excites you the most so we can tailor our events, research, and training opportunities for the upcoming year.
                </p>
            </div>

            <!-- Sign-up Form -->
            <form id="interestForm" class="space-y-6">

                <!-- Personal Information -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label for="firstName" class="block text-sm font-medium text-slate-300 mb-2">First Name</label>
                        <input type="text" id="firstName" name="firstName" required class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:ring-2 focus:ring-cyan-400 transition duration-300" placeholder="John">
                    </div>
                    <div>
                        <label for="lastName" class="block text-sm font-medium text-slate-300 mb-2">Last Name</label>
                        <input type="text" id="lastName" name="lastName" required class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:ring-2 focus:ring-cyan-400 transition duration-300" placeholder="Doe">
                    </div>
                    <div>
                        <label for="email" class="block text-sm font-medium text-slate-300 mb-2">School Email</label>
                        <input type="email" id="email" name="email" required class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:ring-2 focus:ring-cyan-400 transition duration-300" placeholder="j.doe@medschool.edu">
                    </div>
                    <div>
                        <label for="phone" class="block text-sm font-medium text-slate-300 mb-2">Phone Number <span class="text-slate-500">(Optional)</span></label>
                        <input type="tel" id="phone" name="phone" class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:ring-2 focus:ring-cyan-400 transition duration-300" placeholder="(123) 456-7890">
                    </div>
                </div>

                <!-- Interests Accordion -->
                <div>
                    <h3 class="text-lg font-semibold text-cyan-300 mb-4 border-b border-slate-700 pb-2">What are your interests? (Check all that apply)</h3>
                    <div class="space-y-2">
                        <!-- Aerospace Medicine Accordion -->
                        <div class="accordion-item bg-slate-900/50 rounded-lg border border-slate-700">
                            <button type="button" class="accordion-button w-full flex justify-between items-center text-left p-4 font-semibold text-slate-200 hover:bg-slate-700/50 rounded-t-lg">
                                <span>Aerospace Medicine</span>
                                <svg class="accordion-icon w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                            </button>
                            <div class="accordion-content">
                                <div class="p-4 grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                                    <div class="space-y-4">
                                        <h5 class="font-medium text-slate-400">Research & Physiology</h5>
                                        <div class="relative flex items-start"><div class="flex h-5 items-center"><input id="space-research" name="interests" type="checkbox" value="Space Research" class="form-checkbox h-5 w-5 rounded bg-slate-700 border-slate-600 text-blue-500 focus:ring-blue-500"></div><div class="ml-3 text-sm"><label for="space-research" class="font-medium text-slate-300">Space Medicine Research</label><p class="text-xs text-slate-400">Contribute to studies on human health in space, from microgravity to radiation.</p></div></div>
                                        <div class="relative flex items-start"><div class="flex h-5 items-center"><input id="space-physiology" name="interests" type="checkbox" value="Space Physiology" class="form-checkbox h-5 w-5 rounded bg-slate-700 border-slate-600 text-blue-500 focus:ring-blue-500"></div><div class="ml-3 text-sm"><label for="space-physiology" class="font-medium text-slate-300">Spaceflight Physiology & Deconditioning</label><p class="text-xs text-slate-400">Study the effects of spaceflight on the human body and how to counteract them.</p></div></div>
                                        <div class="relative flex items-start"><div class="flex h-5 items-center"><input id="space-radiation" name="interests" type="checkbox" value="Space Radiation" class="form-checkbox h-5 w-5 rounded bg-slate-700 border-slate-600 text-blue-500 focus:ring-blue-500"></div><div class="ml-3 text-sm"><label for="space-radiation" class="font-medium text-slate-300">Space Radiation Health</label><p class="text-xs text-slate-400">Focus on the risks of space radiation and developing protective measures.</p></div></div>
                                        <div class="relative flex items-start"><div class="flex h-5 items-center"><input id="space-behavioral" name="interests" type="checkbox" value="Space Behavioral" class="form-checkbox h-5 w-5 rounded bg-slate-700 border-slate-600 text-blue-500 focus:ring-blue-500"></div><div class="ml-3 text-sm"><label for="space-behavioral" class="font-medium text-slate-300">Behavioral Health in Isolation</label><p class="text-xs text-slate-400">Explore the psychological challenges of long-duration space missions.</p></div></div>
                                    </div>
                                    <div class="space-y-4">
                                        <h5 class="font-medium text-slate-400">Clinical, Operations & Policy</h5>
                                        <div class="relative flex items-start"><div class="flex h-5 items-center"><input id="space-clinical" name="interests" type="checkbox" value="Space Clinical" class="form-checkbox h-5 w-5 rounded bg-slate-700 border-slate-600 text-blue-500 focus:ring-blue-500"></div><div class="ml-3 text-sm"><label for="space-clinical" class="font-medium text-slate-300">Clinical Practice (Aviation/Space)</label><p class="text-xs text-slate-400">Learn about the medical care of pilots, aircrew, and astronauts.</p></div></div>
                                        <div class="relative flex items-start"><div class="flex h-5 items-center"><input id="space-missions" name="interests" type="checkbox" value="Space Missions" class="form-checkbox h-5 w-5 rounded bg-slate-700 border-slate-600 text-blue-500 focus:ring-blue-500"></div><div class="ml-3 text-sm"><label for="space-missions" class="font-medium text-slate-300">Designing Medical Missions for Space</label><p class="text-xs text-slate-400">Help plan the medical systems and protocols for future space voyages.</p></div></div>
                                        <div class="relative flex items-start"><div class="flex h-5 items-center"><input id="space-analog" name="interests" type="checkbox" value="Space Analog" class="form-checkbox h-5 w-5 rounded bg-slate-700 border-slate-600 text-blue-500 focus:ring-blue-500"></div><div class="ml-3 text-sm"><label for="space-analog" class="font-medium text-slate-300">Analog Missions (e.g., NEEMO)</label><p class="text-xs text-slate-400">Participate in Earth-based missions that simulate space environments.</p></div></div>
                                        <div class="relative flex items-start"><div class="flex h-5 items-center"><input id="space-tech" name="interests" type="checkbox" value="Space Tech" class="form-checkbox h-5 w-5 rounded bg-slate-700 border-slate-600 text-blue-500 focus:ring-blue-500"></div><div class="ml-3 text-sm"><label for="space-tech" class="font-medium text-slate-300">Space Med Technology Development</label><p class="text-xs text-slate-400">Innovate new medical devices and software for use in space.</p></div></div>
                                        <div class="relative flex items-start"><div class="flex h-5 items-center"><input id="space-policy" name="interests" type="checkbox" value="Space Policy" class="form-checkbox h-5 w-5 rounded bg-slate-700 border-slate-600 text-blue-500 focus:ring-blue-500"></div><div class="ml-3 text-sm"><label for="space-policy" class="font-medium text-slate-300">Aerospace Policy & Ethics</label><p class="text-xs text-slate-400">Discuss the laws, ethics, and guidelines that govern space medicine.</p></div></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Dive Medicine Accordion -->
                        <div class="accordion-item bg-slate-900/50 rounded-lg border border-slate-700">
                            <button type="button" class="accordion-button w-full flex justify-between items-center text-left p-4 font-semibold text-slate-200 hover:bg-slate-700/50 rounded-t-lg">
                                <span>Dive Medicine</span>
                                <svg class="accordion-icon w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                            </button>
                            <div class="accordion-content">
                               <div class="p-4 grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                                    <div class="space-y-4">
                                        <h5 class="font-medium text-slate-400">Clinical & Research</h5>
                                        <div class="relative flex items-start"><div class="flex h-5 items-center"><input id="dive-research" name="interests" type="checkbox" value="Dive Research" class="form-checkbox h-5 w-5 rounded bg-slate-700 border-slate-600 text-blue-500 focus:ring-blue-500"></div><div class="ml-3 text-sm"><label for="dive-research" class="font-medium text-slate-300">Hyperbaric & Dive Research</label><p class="text-xs text-slate-400">Investigate the effects of pressure on the body and hyperbaric treatments.</p></div></div>
                                        <div class="relative flex items-start"><div class="flex h-5 items-center"><input id="dive-clinical" name="interests" type="checkbox" value="Dive Clinical" class="form-checkbox h-5 w-5 rounded bg-slate-700 border-slate-600 text-blue-500 focus:ring-blue-500"></div><div class="ml-3 text-sm"><label for="dive-clinical" class="font-medium text-slate-300">Clinical Dive Medicine</label><p class="text-xs text-slate-400">Focus on the diagnosis and treatment of diving-related injuries and illnesses.</p></div></div>
                                        <div class="relative flex items-start"><div class="flex h-5 items-center"><input id="dive-support" name="interests" type="checkbox" value="Dive Support" class="form-checkbox h-5 w-5 rounded bg-slate-700 border-slate-600 text-blue-500 focus:ring-blue-500"></div><div class="ml-3 text-sm"><label for="dive-support" class="font-medium text-slate-300">Medical Support for Scientific Dives</label><p class="text-xs text-slate-400">Provide medical oversight for underwater research and exploration.</p></div></div>
                                        <div class="relative flex items-start"><div class="flex h-5 items-center"><input id="dive-safety" name="interests" type="checkbox" value="Dive Safety" class="form-checkbox h-5 w-5 rounded bg-slate-700 border-slate-600 text-blue-500 focus:ring-blue-500"></div><div class="ml-3 text-sm"><label for="dive-safety" class="font-medium text-slate-300">Dive Safety & Accident Investigation</label><p class="text-xs text-slate-400">Learn to analyze dive accidents and improve safety procedures.</p></div></div>
                                    </div>
                                    <div class="space-y-4">
                                        <h5 class="font-medium text-slate-400">Training & Certification</h5>
                                        <div class="relative flex items-start"><div class="flex h-5 items-center"><input id="dive-cert" name="interests" type="checkbox" value="Dive Cert" class="form-checkbox h-5 w-5 rounded bg-slate-700 border-slate-600 text-blue-500 focus:ring-blue-500"></div><div class="ml-3 text-sm"><label for="dive-cert" class="font-medium text-slate-300">Gaining Dive Certifications</label><p class="text-xs text-slate-400">Get certified for recreational or scientific diving (e.g., Open Water, Rescue Diver).</p></div></div>
                                        <div class="relative flex items-start"><div class="flex h-5 items-center"><input id="dmt-cert" name="interests" type="checkbox" value="DMT Cert" class="form-checkbox h-5 w-5 rounded bg-slate-700 border-slate-600 text-blue-500 focus:ring-blue-500"></div><div class="ml-3 text-sm"><label for="dmt-cert" class="font-medium text-slate-300">Dive Medical Technician (DMT) Cert</label><p class="text-xs text-slate-400">Pursue advanced training to manage dive accidents and provide chamber support.</p></div></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Expedition Medicine Accordion -->
                        <div class="accordion-item bg-slate-900/50 rounded-lg border border-slate-700">
                            <button type="button" class="accordion-button w-full flex justify-between items-center text-left p-4 font-semibold text-slate-200 hover:bg-slate-700/50 rounded-t-lg">
                                <span>Expedition Medicine</span>
                                <svg class="accordion-icon w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                            </button>
                            <div class="accordion-content">
                                <div class="p-4 grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                                    <div class="space-y-4">
                                        <h5 class="font-medium text-slate-400">Field Practice</h5>
                                        <div class="relative flex items-start"><div class="flex h-5 items-center"><input id="expedition-physician" name="interests" type="checkbox" value="Expedition Physician" class="form-checkbox h-5 w-5 rounded bg-slate-700 border-slate-600 text-blue-500 focus:ring-blue-500"></div><div class="ml-3 text-sm"><label for="expedition-physician" class="font-medium text-slate-300">Working on Expeditions as a Physician</label><p class="text-xs text-slate-400">Provide medical care for teams in remote locations like mountains or jungles.</p></div></div>
                                        <div class="relative flex items-start"><div class="flex h-5 items-center"><input id="wilderness" name="interests" type="checkbox" value="Wilderness" class="form-checkbox h-5 w-5 rounded bg-slate-700 border-slate-600 text-blue-500 focus:ring-blue-500"></div><div class="ml-3 text-sm"><label for="wilderness" class="font-medium text-slate-300">Wilderness & Remote Medicine</label><p class="text-xs text-slate-400">Learn to practice medicine with limited resources in austere environments.</p></div></div>
                                        <div class="relative flex items-start"><div class="flex h-5 items-center"><input id="high-altitude" name="interests" type="checkbox" value="High Altitude" class="form-checkbox h-5 w-5 rounded bg-slate-700 border-slate-600 text-blue-500 focus:ring-blue-500"></div><div class="ml-3 text-sm"><label for="high-altitude" class="font-medium text-slate-300">High-Altitude & Mountaineering Med</label><p class="text-xs text-slate-400">Specialize in illnesses and injuries unique to mountain environments.</p></div></div>
                                        <div class="relative flex items-start"><div class="flex h-5 items-center"><input id="humanitarian" name="interests" type="checkbox" value="Humanitarian" class="form-checkbox h-5 w-5 rounded bg-slate-700 border-slate-600 text-blue-500 focus:ring-blue-500"></div><div class="ml-3 text-sm"><label for="humanitarian" class="font-medium text-slate-300">Disaster & Humanitarian Medicine</label><p class="text-xs text-slate-400">Provide medical aid in response to natural disasters or humanitarian crises.</p></div></div>
                                    </div>
                                    <div class="space-y-4">
                                        <h5 class="font-medium text-slate-400">Training & Certification</h5>
                                        <div class="relative flex items-start"><div class="flex h-5 items-center"><input id="wfr-cert" name="interests" type="checkbox" value="WFR Cert" class="form-checkbox h-5 w-5 rounded bg-slate-700 border-slate-600 text-blue-500 focus:ring-blue-500"></div><div class="ml-3 text-sm"><label for="wfr-cert" class="font-medium text-slate-300">Wilderness First Responder (WFR) Cert</label><p class="text-xs text-slate-400">Obtain the industry standard certification for wilderness medical professionals.</p></div></div>
                                        <div class="relative flex items-start"><div class="flex h-5 items-center"><input id="sar-training" name="interests" type="checkbox" value="SAR Training" class="form-checkbox h-5 w-5 rounded bg-slate-700 border-slate-600 text-blue-500 focus:ring-blue-500"></div><div class="ml-3 text-sm"><label for="sar-training" class="font-medium text-slate-300">Search and Rescue (SAR) Training</label><p class="text-xs text-slate-400">Learn the skills needed to find and provide aid to persons in distress.</p></div></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Submit Button -->
                <div class="text-center pt-4">
                    <button id="submitButton" type="submit" class="font-orbitron bg-cyan-500 hover:bg-cyan-400 text-slate-900 font-bold py-3 px-10 rounded-full text-lg transition-all duration-300 transform hover:scale-105 shadow-lg shadow-cyan-500/20 flex items-center justify-center w-full md:w-auto mx-auto">
                        <span id="buttonText">Join Our Mission</span>
                        <span id="buttonLoader" class="hidden loader"></span>
                    </button>
                </div>
            </form>
            
            <!-- Submission Messages -->
            <div id="submissionMessage" class="hidden text-center mt-8">
                <div class="p-4 bg-green-900/50 border border-green-700 rounded-lg">
                    <p class="font-semibold text-green-300">Thank you! Your submission has been received.</p>
                </div>
                <button id="newFormButton" class="mt-6 font-orbitron bg-slate-600 hover:bg-slate-500 text-white font-bold py-3 px-10 rounded-full text-lg transition-all duration-300 transform hover:scale-105">
                    Next Student
                </button>
            </div>
            <div id="errorMessage" class="hidden text-center mt-8 p-4 bg-red-900/50 border border-red-700 rounded-lg">
                <!-- Error messages will be inserted here by the script -->
            </div>

        </div>
    </div>

    <script>
        // --- Element References ---
        const form = document.getElementById('interestForm');
        const submitButton = document.getElementById('submitButton');
        const buttonText = document.getElementById('buttonText');
        const buttonLoader = document.getElementById('buttonLoader');
        const submissionMessage = document.getElementById('submissionMessage');
        const errorMessage = document.getElementById('errorMessage');
        const newFormButton = document.getElementById('newFormButton');
        const header = document.getElementById('header');

        // --- Accordion Logic ---
        const accordionButtons = document.querySelectorAll('.accordion-button');
        accordionButtons.forEach(button => {
            button.addEventListener('click', () => {
                const content = button.nextElementSibling;
                accordionButtons.forEach(otherButton => {
                    if (otherButton !== button) {
                        otherButton.classList.remove('open');
                        otherButton.nextElementSibling.classList.remove('open');
                    }
                });
                button.classList.toggle('open');
                content.classList.toggle('open');
            });
        });

        // --- Form Submission Logic ---
        const googleScriptURL = 'https://script.google.com/macros/s/AKfycby7ik9s_bBzS1Kx9ObRhqQ1ln7U0FxR9WznbPZoxtSukDyPrJbbgiBBggQnMoN0vLeF/exec';

        form.addEventListener('submit', function(event) {
            event.preventDefault(); 
            
            buttonText.classList.add('hidden');
            buttonLoader.classList.remove('hidden');
            submitButton.disabled = true;
            errorMessage.classList.add('hidden');

            const formData = new FormData(form);
            
            // Special handling for checkboxes
            const interests = Array.from(form.querySelectorAll('input[name="interests"]:checked')).map(cb => cb.value);
            formData.set('interests', interests.join(', '));


            fetch(googleScriptURL, {
                method: 'POST',
                body: formData,
            })
            .then(response => {
                if (response.ok || response.type === 'opaque') {
                    header.classList.add('hidden');
                    form.classList.add('hidden');
                    submissionMessage.classList.remove('hidden');
                } else {
                    return response.text().then(text => { throw new Error(`Server responded with an error: ${text}`) });
                }
            })
            .catch(error => {
                console.error('Error!', error);
                errorMessage.innerHTML = `<p class="font-semibold text-red-300">Submission failed. Please try again.</p><p class="text-sm text-red-400 mt-2">${error.message}</p>`;
                errorMessage.classList.remove('hidden');
                buttonText.classList.remove('hidden');
                buttonLoader.classList.add('hidden');
                submitButton.disabled = false;
            });
        });

        // --- New Form Button Logic ---
        newFormButton.addEventListener('click', () => {
            submissionMessage.classList.add('hidden');
            header.classList.remove('hidden');
            form.classList.remove('hidden');
            form.reset();
            buttonText.classList.remove('hidden');
            buttonLoader.classList.add('hidden');
            submitButton.disabled = false;
            accordionButtons.forEach(button => {
                button.classList.remove('open');
                button.nextElementSibling.classList.remove('open');
            });
        });

        // --- Animated Starfield Background ---
        const canvas = document.getElementById('starfield');
        const ctx = canvas.getContext('2d');

        function setCanvasSize() {
            canvas.width = window.innerWidth;
            canvas.height = document.body.scrollHeight;
        }

        let stars = [];
        let comets = [];
        const numStars = 400;

        function Star(x, y, radius, opacity) {
            this.x = x; this.y = y; this.radius = radius; this.opacity = opacity;
            this.fadingIn = true; this.fadeSpeed = Math.random() * 0.015;
        }

        Star.prototype.draw = function() {
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
            ctx.fillStyle = `rgba(255, 255, 255, ${this.opacity})`;
            ctx.fill();
        };

        Star.prototype.update = function() {
            if (this.fadingIn) {
                this.opacity += this.fadeSpeed;
                if (this.opacity >= 1) { this.opacity = 1; this.fadingIn = false; }
            } else {
                this.opacity -= this.fadeSpeed;
                if (this.opacity <= 0.1) { this.opacity = 0.1; this.fadingIn = true; }
            }
        };

        function Comet() { this.reset(); }

        Comet.prototype.reset = function() {
            this.x = Math.random() * canvas.width; this.y = 0;
            this.radius = Math.random() * 2 + 1;
            this.speed = { x: (Math.random() - 0.5) * 10, y: Math.random() * 5 + 5 };
            this.length = Math.random() * 80 + 50; this.opacity = 1;
        };

        Comet.prototype.draw = function() {
            for (let i = 0; i < this.length; i++) {
                ctx.beginPath();
                const trailX = this.x - this.speed.x * i;
                const trailY = this.y - this.speed.y * i;
                const trailOpacity = this.opacity * (1 - i / this.length);
                ctx.arc(trailX, trailY, this.radius, 0, Math.PI * 2);
                ctx.fillStyle = `rgba(173, 216, 230, ${trailOpacity})`;
                ctx.fill();
            }
        };

        Comet.prototype.update = function() {
            this.x += this.speed.x; this.y += this.speed.y;
            if (this.y > canvas.height) { this.reset(); }
        };

        function init() {
            setCanvasSize();
            stars = [];
            for (let i = 0; i < numStars; i++) {
                stars.push(new Star(Math.random() * canvas.width, Math.random() * canvas.height, Math.random() * 1.5, Math.random()));
            }
            comets = [new Comet(), new Comet()];
        }

        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            stars.forEach(star => { star.update(); star.draw(); });
            comets.forEach(comet => { comet.update(); comet.draw(); });
            requestAnimationFrame(animate);
        }
        
        setInterval(() => { if (comets.length < 3) { comets.push(new Comet()); } }, 5000);

        window.addEventListener('resize', init);
        init();
        animate();
    </script>

</body>
</html>
